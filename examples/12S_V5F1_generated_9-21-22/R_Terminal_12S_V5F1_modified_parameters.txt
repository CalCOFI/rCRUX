> library(rCRUX)
>
>
> blast_seeds_parent <- "/Users/limeybean/Dropbox/CRUX_2.0/12S_V5F1_modified_params/"
> metabarcode <- "12S_V5F1"
> accession_taxa_path <- "/Users/limeybean/Dropbox/CRUX_2.0/accession2taxid/accessionTaxa.sql"
>
> get_blast_seeds("TAGAACAGGCTCCTCTAG", "TTAGATACCCCACTATGC",
+                 blast_seeds_parent, metabarcode, accession_taxa_path, HITSIZE ='1000000', evalue='100000',
+                 word_size='6', MAX_TARGET_PER_TEMPLATE = '5',
+                 NUM_TARGETS_WITH_PRIMERS ='500000', minimum_length = 60,
+                 MAX_TARGET_SIZE = 200,
+                 organism = c("1476529", "7776"), return_table = FALSE)
BLASTing 1 primer combinations
Submitting Primer-BLAST query
BLAST alignment processing, refreshing in 20 seconds...
BLAST alignment completed in 30 seconds
BLASTing 1 primer combinations
Submitting Primer-BLAST query
BLAST alignment processing, refreshing in 20 seconds...
BLAST alignment processing, refreshing in 20 seconds...
BLAST alignment processing, refreshing in 20 seconds...
BLAST alignment processing, refreshing in 20 seconds...
BLAST alignment processing, refreshing in 20 seconds...
BLAST alignment processing, refreshing in 20 seconds...
BLAST alignment processing, refreshing in 20 seconds...
BLAST alignment processing, refreshing in 20 seconds...
BLAST alignment completed in 228 seconds
NULL
>
>
>
>
>
>
> seeds_path <- '/Users/limeybean/Dropbox/CRUX_2.0/12S_V5F1_modified_params/12S_V5F1/12S_V5F1_primerTree_output_with_taxonomy.csv'
> db_dir <- "/Users/limeybean/Dropbox/CRUX_2.0/ncbi_nt/nt"
> accession_taxa_path <- "/Users/limeybean/Dropbox/CRUX_2.0/accession2taxid/accessionTaxa.sql"
> working_dir <- '/Users/limeybean/Dropbox/CRUX_2.0/12S_V5F1_modified_params/12S_V5F1/'
> metabarcode <- "12S_V5F1"
>
> rcrux_blast(seeds_path, db_dir, accession_taxa_path, working_dir,
+             metabarcode)

### missing a little here....


130054 unique blast hits after this round.
Running blastdbcmd on 1000 samples.
Calling blastn. This may take a long time.
6248867 blast hits returned.
130604 unique blast hits after this round.
Running blastdbcmd on 1000 samples.
Calling blastn. This may take a long time.
8319980 blast hits returned.
144192 unique blast hits after this round.
Running blastdbcmd on 566 samples.
Calling blastn. This may take a long time.
5751334 blast hits returned.
145633 unique blast hits after this round.
5
BLAST round 7
1238 indices left to process.
genus has 17 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 17 samples.
Calling blastn. This may take a long time.
522 blast hits returned.
145786 unique blast hits after this round.
5
BLAST round 8
1117 indices left to process.
genus has 2 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 2 samples.
Calling blastn. This may take a long time.
95 blast hits returned.
145850 unique blast hits after this round.
5
BLAST round 9
1104 indices left to process.
genus has 7 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 7 samples.
Calling blastn. This may take a long time.
42 blast hits returned.
145868 unique blast hits after this round.
5
BLAST round 10
1085 indices left to process.
genus has 6 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 6 samples.
Calling blastn. This may take a long time.
102 blast hits returned.
145935 unique blast hits after this round.
5
BLAST round 11
1077 indices left to process.
genus has 7 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 7 samples.
Calling blastn. This may take a long time.
30 blast hits returned.
145948 unique blast hits after this round.
5
BLAST round 12
1063 indices left to process.
genus has 9 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 9 samples.
Calling blastn. This may take a long time.
111 blast hits returned.
145984 unique blast hits after this round.
5
BLAST round 13
1047 indices left to process.
genus has 4 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 4 samples.
Calling blastn. This may take a long time.
45 blast hits returned.
145988 unique blast hits after this round.
5
BLAST round 14
1043 indices left to process.
genus has 2 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 2 samples.
No useable accession numbers. Proceeding to next round.
145988 unique blast hits after this round.
5
BLAST round 15
1043 indices left to process.
genus has 3 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 3 samples.
Calling blastn. This may take a long time.
28 blast hits returned.
145994 unique blast hits after this round.
5
BLAST round 16
1036 indices left to process.
genus has 5 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 5 samples.
Calling blastn. This may take a long time.
17202 blast hits returned.
146006 unique blast hits after this round.
5
BLAST round 17
1029 indices left to process.
genus has 6 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 6 samples.
Calling blastn. This may take a long time.
95 blast hits returned.
146032 unique blast hits after this round.
5
BLAST round 18
1011 indices left to process.
genus has 2 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 2 samples.
No useable accession numbers. Proceeding to next round.
146032 unique blast hits after this round.
5
BLAST round 19
1011 indices left to process.
genus has 2 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 2 samples.
Calling blastn. This may take a long time.
65 blast hits returned.
146056 unique blast hits after this round.
5
BLAST round 20
1009 indices left to process.
genus has 2 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 2 samples.
Calling blastn. This may take a long time.
5 blast hits returned.
146061 unique blast hits after this round.
5
BLAST round 21
1005 indices left to process.
genus has 1 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 1 samples.
No useable accession numbers. Proceeding to next round.
146061 unique blast hits after this round.
5
BLAST round 22
1005 indices left to process.
genus has 1 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 1 samples.
No useable accession numbers. Proceeding to next round.
146061 unique blast hits after this round.
5
BLAST round 23
1005 indices left to process.
genus has 5 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 5 samples.
Calling blastn. This may take a long time.
126 blast hits returned.
146069 unique blast hits after this round.
5
BLAST round 24
997 indices left to process.
genus has 997 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 997 samples.
Calling blastn. This may take a long time.
1954001 blast hits returned.
146221 unique blast hits after this round.
5
BLAST round 25
0 indices left to process.
genus has 0 unique occurrences in the blast seeds data table.
These will be subsets into chunks of  1000  indices or fewer
Running blastdbcmd on 0 samples.
No useable accession numbers. Proceeding to next round.
146221 unique blast hits after this round.
NULL
Warning message:
In dir.create(working_dir) :
  '/Users/limeybean/Dropbox/CRUX_2.0/12S_V5F1_modified_params1/12S_V5F1' already exists
>
>
>
# This example shows an error generated if the user tries to blast more
# seeds than their RAM can support
>
> seeds_path <- '/Users/limeybean/Dropbox/CRUX_2.0/12S_V5F1_modified_params/12S_V5F1/12S_V5F1_primerTree_output_with_taxonomy.csv'
> db_dir <- "/Users/limeybean/Dropbox/CRUX_2.0/ncbi_nt/nt"
> accession_taxa_path <- "/Users/limeybean/Dropbox/CRUX_2.0/accession2taxid/accessionTaxa.sql"
> working_dir <- '/Users/limeybean/Dropbox/CRUX_2.0/12S_V5F1_modified_params/12S_V5F1/'
> metabarcode <- "12S_V5F1"
>
>
>
> rcrux_blast(seeds_path, db_dir, accession_taxa_path, working_dir,
+             metabarcode, max_to_blast = 2000)
Max to blast 2000
BLAST round 1
111489 indices left to process.
Running blastdbcmd on 5568 samples.
Calling blastn. This may take a long time.
0 blast hits returned.
Error in blast_datatable(blast_seeds, save_dir, db_dir, accession_taxa_path,  :
  Blastn having trouble blasting the number of seeds selected.  Try using a taxonomic rank with fewer unique groups, and reduce the value for max_to_blast
In addition: Warning messages:
1: In dir.create(working_dir) :
  '/Users/limeybean/Dropbox/CRUX_2.0/12S_V5F1_modified_params/12S_V5F1' already exists
>

### This marker returns more hits when I randomly search genus, than the RAM on
### my computer can store.  I choose to go up one taxonomic rank, to family, and
### was able to complete the run.
###
### I increased the max_to_blast = 2000 from the default of 1000.  After the
### first round of blast at the rank of family, there were few families left to
### sample, and it took about 200 rounds of blast to get to 1000 accessions
### left to blast.
### This script saves the status from the most recently completed round of blast
### so you can stop the script if it appears to be running slowly and modify the
### parameters to speed up the database build.
>

>
