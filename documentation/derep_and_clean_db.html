<!DOCTYPE html><html><head><title>R: De-replicates identical sequences and finds the lowest...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table style="width: 100%;"><tr><td>derep_and_clean_db {rCRUX}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>De-replicates identical sequences and finds the lowest taxonomic agreement
for sequences with multiple taxids</h2>

<h3>Description</h3>

<p>derep_and_clean_db takes the output from <code>blast_seed()</code> and
de-replicates the dataset to identify representative sequences. It generates
an out put directory <code>derep_and_clean_db</code> at <code>output_directory_path</code> to store
the output .csv files and the fasta and taxonomy file generated by the function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>derep_and_clean_db(output_directory_path, summary_path, metabarcode_name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr style="vertical-align: top;"><td><code>output_directory_path</code></td>
<td>
<p>the path to the output directory</p>
</td></tr>
<tr style="vertical-align: top;"><td><code>summary_path</code></td>
<td>
<p>the path to the input file</p>
</td></tr>
<tr style="vertical-align: top;"><td><code>metabarcode_name</code></td>
<td>
<p>used to name the subdirectory and the files.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Before de-replicating the data set, all sequences with NA taxonomy for phylum,
class, order, family, and genus are removed from the dataset because they
typically represent environmental samples with low value for taxonomic
classification. These sequences are stored in a
<code>Sequences_with_mostly_NA_taxonomic_paths.csv</code>
</p>
<p>All sequences with the same length and composition are collapsed to a single
database entry, where the accessions and taxids (if there are more than one)
are concatenated. The sequences with a clean taxonomic path (e.g. no ranks
with multiple entries) are written to <code>Sequences_with_single_taxonomic_path.csv</code>.
</p>
<p>Sequences with multiple entries for a given taxonomic rank are written to
<code>Sequences_with_multiple_taxonomic_paths.cvs</code>. These sequences are processed
further by removing NAs from rank instances with more than one entry
(e.g. &quot;Chordata, NA&quot; will mutate to &quot;Chordata&quot;). Any remaining instances
of taxonomic ranks with more than one taxid will be reduced to NA
(e.g. &quot;Badis assamensis, Badis badis&quot; will mutate to &quot;NA&quot;). These sequences,
with a taxonomic paths shortened to the lowest taxonomic agreement, are written
to <code>Sequences_with_lowest_common_taxonomic_path_agreement.csv</code>.
</p>
<p>Lastly, the sequences from <code>Sequences_with_single_taxonomic_path.csv</code>
and <code>Sequences_with_lowest_common_taxonomic_path_agreement.csv</code> are used to
generate a fasta file and taxonomy file of representative NCBI accessions for
each sequence. The number of accessions identical to the representative
accession is given.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
output_directory_path &lt;- "/my/directory/12S_V5F1_remote_111122_modified_params"
summary_path &lt;- "/my/directory/12S_V5F1_remote_111122_modified_params/blast_seeds_output/summary.csv"
metabarcode_name &lt;- "12S_V5F1"


derep_and_clean_db(output_directory_path, summary_path, metabarcode_name)


</code></pre>

<hr /><div style="text-align: center;">[Package <em>rCRUX</em> version 0.0.1.000 ]</div>
</div>
</body></html>
